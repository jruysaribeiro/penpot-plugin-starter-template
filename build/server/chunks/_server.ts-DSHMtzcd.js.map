{"version":3,"file":"_server.ts-DSHMtzcd.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/gemini/_server.ts.js"],"sourcesContent":["import { json } from \"@sveltejs/kit\";\nimport dotenv from \"dotenv\";\ndotenv.config();\nconst GEMINI_API_KEY = process.env.GEMINI_API_KEY;\nconsole.log(\n  \"✓ API route loaded. API key status:\",\n  GEMINI_API_KEY ? \"✓ SET\" : \"✗ MISSING\"\n);\nconst GET = async () => {\n  console.log(\"GET /api/gemini - Fetching models list\");\n  if (!GEMINI_API_KEY) {\n    return json({ error: \"API key not configured\" }, { status: 500 });\n  }\n  try {\n    const response = await fetch(\n      `https://generativelanguage.googleapis.com/v1beta/models?key=${GEMINI_API_KEY}`\n    );\n    if (!response.ok) {\n      const error = await response.json();\n      return json(\n        {\n          error: error.error?.message || \"Failed to fetch models\"\n        },\n        { status: response.status }\n      );\n    }\n    const result = await response.json();\n    return json(result);\n  } catch (error) {\n    console.error(\"Gemini API error:\", error);\n    return json({ error: \"Internal server error\" }, { status: 500 });\n  }\n};\nconst POST = async ({ request }) => {\n  console.log(\"POST /api/gemini - Processing AI request\");\n  if (!GEMINI_API_KEY) {\n    return json({ error: \"API key not configured\" }, { status: 500 });\n  }\n  try {\n    const { base64Data, model, action, prompt } = await request.json();\n    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/models/${model}:generateContent?key=${GEMINI_API_KEY}`;\n    let requestBody = {};\n    if (action === \"background-removal\") {\n      requestBody = {\n        contents: [\n          {\n            parts: [\n              {\n                text: \"Remove the background from this image. Return ONLY the subject with a transparent background as a PNG image. Do not add text or explanations - output the image directly.\"\n              },\n              {\n                inline_data: {\n                  mime_type: \"image/png\",\n                  data: base64Data\n                }\n              }\n            ]\n          }\n        ],\n        generationConfig: {\n          response_mime_type: \"image/png\"\n        }\n      };\n    } else if (action === \"translation\") {\n      requestBody = {\n        contents: [\n          {\n            parts: [\n              {\n                text: prompt\n              }\n            ]\n          }\n        ]\n      };\n    } else {\n      return json({ error: \"Invalid action\" }, { status: 400 });\n    }\n    const response = await fetch(apiUrl, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(requestBody)\n    });\n    if (!response.ok) {\n      const error = await response.json();\n      return json(\n        {\n          error: error.error?.message || \"Generation failed\"\n        },\n        { status: response.status }\n      );\n    }\n    const result = await response.json();\n    return json(result);\n  } catch (error) {\n    console.error(\"Gemini API error:\", error);\n    return json(\n      {\n        error: error instanceof Error ? error.message : \"Internal server error\"\n      },\n      { status: 500 }\n    );\n  }\n};\nexport {\n  GET,\n  POST\n};\n"],"names":[],"mappings":"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"}